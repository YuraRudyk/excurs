# TYPO3 CMS Skeleton
Package provides project skeleton based on TYPO3 CMS.

## Install
Initial install:
```
git clone git@git.711media.de:TYPO3/skeleton.git project-name
cd project-name
rm -rf .git
git init
git remote add origin <origin-url>
git add .
git commit -m "Initial commit"
git push -u origin master
git checkout -b develop master
git push -u origin develop
```

Make sure if composer is installed on your local development environment.

```bash
composer --version
```

If composer is not installed, then follow at [composer website](https://getcomposer.org/download/) download it and install.

```NOTICE: If you prefer to install composer in project's root folder then make sure that you added composer.phar to .gitignore!``` 

To install TYPO3 CMS and all the required dependencies execute:

```bash
composer install
```

Also it will create typo3cms file which is a symlink to executing file of typo3_console package in project's root folder.

## New folder structure
```
- conf
- src
- var
- vendor
- web
    - fileadmin
    - templates
      typo3 (symlink) -> ../vendor/typo3/cms/typo3
    - typo3conf
        - ext
            ...
            - sem_content
            - sem_sitepackage
            ...
          AdditionalConfiguration.php
          LocalConfiguration.php
          PackageStates.php
    - typo3temp
    - uploads
      index.php (symlink) -> ../vendor/typo3/cms/index.php
```

Folder `conf` stores configurations for different environments based on Application_Context.

Folder `src` contains code of configuration loader. Just ignore it.

Folder `var` contains cache, logs generated by configuration loader.
 
Folder `vendor` is generated by composer. It stores code of dependent packages and autoload.php

Folder `web` is a working folder of current project.


## How to add new extension to dependencies?
To add new dependencies you have to edit composer.json file.
F.e. we need to add `powermail` extension.

First go to https://typo3.org/extensions/repository/ and check what the latest available version of `powermail` is.
Then go in composer.json file and append it to section `require`:
```json
{
    "require": {
        ...
        "typo3-ter/powermail": "^3.7.0"
    }
    ...
} 
```
After that just execute:
`composer update` Composer will install powermail and all required extension dependencies for it.

`NOTICE: If extension key contains underscores, then in composer.json require section underscores must be replaced by dashes 
f.e. typo3-ter/rlmp-language-detection`

## What is `.env-example` and how to use it?
`.env-example` is an example of environment configuration file. It was introduced to make easily resolving development and production
environments. To start using it just rename it to .env

"Huh? What? It's going so complicated now. What's next? Why did they add it?" - you would ask me.

The reason is that it simplifies handling of different configuration like:
 * Database connection
 * Imagemagick/Graphicsmagick configurations
 * Mail configurations
 
 And the other options which are available in `$GLOBALS['TYPO3_CONF_VARS']` array 

For example: you want to specify database connection credentials. Yes, please:
```
TYPO3__DB__database="typo3_skeleton"
TYPO3__DB__host="mysql"
TYPO3__DB__password="root"
TYPO3__DB__port="3306"
TYPO3__DB__username="root"
```

Or you want to enable SQL queries debug
```
TYPO3__SYS__sqlDebug="1"
```

Or you want to change Application Context. Just append to `.env` file
```
TYPO3_CONTEXT="Development"
```

Alright, what about `InstallTool`, `LocalConfiguration.php` and `AdditionalConfiguration.php` now?

It's prohibited now to change something in LocalConfiguration.php, AdditionalConfiguration.php directly or via InstallTool.

## How to use `typo3cms`?
Extension [typo3_console](https://typo3.org/extensions/repository/view/typo3_console) allows you to use 
command line interface for easily resolving tasks like:
* Flush caches
* Update database schema
* Activate extensions
* Deactivate extensions

The full reference of available commands are listed at https://docs.typo3.org/typo3cms/extensions/typo3_console/CommandReference/Index.html

## FAQ
Question: How to flush cache?

Answer: `./typo3cms cache:flush`

Question: How to update database schema?

Answer: `./typo3cms database:updateschema "*.add,*.change" --verbose`

Question: How to activate/deactivate extensions?

Answer:
``` 
./typo3cms extension:activate sem_content
./typo3cms extension:deactivate sem_content
```
